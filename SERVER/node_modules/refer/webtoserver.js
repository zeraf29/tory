var socketio = require('socket.io')
 , express = require('express')
 , http = require('http')
 , fs = require('fs');

var app = express();
app.set('port', 8887); // 포트수정
var server = http.createServer(app).listen(app.get('port'), function () {
        console.log("서버 가동. 포트 : " + app.get('port'));
});

app.get('/', function (req, res) {
        fs.readFile('index.html', function (error, data) {
                res.writeHead(200, {'Content-Type': 'text/html'});
                res.end(data);
        });
});

app.get('/imgs', function (req, res) {
        fs.readFile('123.png', function (error, data) {
                res.writeHead(200, {'Content-Type': 'text/html'});
                res.end(data);
        });
});

var io = socketio.listen(server);

io.sockets.on('connection', function (socket) {
        socket.on('message', function (message) {
                io.sockets.emit('message', message);
        });
       /* socket.on('imgs', function (imgs) {
                fs.readFile('123.png', function (error, data) {
                        res.writeHead(200, { 'Content-Type': 'text/html' });
                        res.end(data);
                });
                sockets.broadcast.emit('imgs', imgs);
        });*/
});

